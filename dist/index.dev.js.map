{"version":3,"file":"index.dev.js","sources":["../src/utils.ts","../src/gridbounds.ts","../src/markermanager.ts"],"sourcesContent":[null,null,null],"names":["latLngToPixel","latlng","zoom","google","maps","Point","lng","lat","sinofphi","Math","sin","PI","log","GridBounds","bounds","z","_classCallCheck","this","minX","min","x","maxX","max","minY","y","maxY","_createClass","key","value","gridBounds","point","MarkerManager","map","_ref","_this","_ref$maxZoom","maxZoom","trackMarkers","_ref$shown","shown","_ref$borderPadding","borderPadding","_tileSize","_map","_mapZoom","getZoom","_maxZoom","_trackMarkers","_swPadding","Size","_nePadding","_gridWidth","_grid","_numMarkers","shownMarkers","event","addListenerOnce","_initialize","mapTypes","sType","get","addListener","_onMapMoveEnd","bind","resetManager","_shownBounds","_getMapGridBounds","trigger","marker","setMap","mapWidth","ceil","_processAll","_removeOverlay","padding","pixelPoint","floor","width","height","minZoom","_this2","mPoint","getPosition","set","oldPoint","newPoint","_onMarkerMoved","gridPoint","_getTilePoint","_getGridCellCreate","push","vertical","horizontal","changed","oldGrid","newGrid","cell","_getGridCellNoCreate","_removeMarkerFromCell","_isGridPointVisible","_addOverlay","_notifyListeners","grid","markers","_getOptmaxZoom","i","length","_addMarkerBatch","total","LatLng","Marker","position","undefined","swPadding","nePadding","bl","getSouthWest","tr","getNorthEast","sw","ne","gw","_getGridBounds","getBounds","window","setTimeout","_updateMarkers","refresh","show","newBounds","equals","_rectangleDiff","_removeCellMarkers","_addCellMarkers","callback","_processCellMarkers","bounds1","bounds2","_rectangleDiffCoords","minX1","minY1","maxX1","maxY1","minX2","minY2","maxX2","maxY2","shift","splice"],"mappings":"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"}